@using Sidekick.Apis.Poe.Items
@using Sidekick.Apis.Poe.Trade.Trade.Filters.Types

<FilterWrapper>
    <div class="flex flex-nowrap items-center min-h-5 font-caps">
        <ItemStatText Class="text-left text-nowrap"
                      Category="StatCategory.GrayText">@Filter.Text:
        </ItemStatText>

        <div class="grow">
            <FormSelectInline Options="Options"
                              Value="@Filter.Value"
                              ValueChanged="@Changed"/>
        </div>

        <div class="leading-none flex items-center justify-end w-5">
            @if (Filter.Value != Filter.DefaultValue)
            {
                <ButtonIcon OnClick="@ClearSetting">
                    <Icon Svg="@UiIcons.Reset" Size="UiIconSize.Small"/>
                </ButtonIcon>
            }
        </div>
    </div>
</FilterWrapper>

@code {

    [Parameter]
    public required OptionFilter Filter { get; set; }

    private List<SelectOption> Options => Filter.Options.Select(x => new SelectOption()
    {
        Label = x.Text ?? string.Empty,
        Value = x.Value ?? string.Empty,
    }).ToList();

    private async Task Changed(string? value)
    {
        Filter.Value = value;
        await Filter.OnChanged();
    }

    private async Task ClearSetting()
    {
        Filter.Value = Filter.DefaultValue;
        await Filter.OnChanged();
    }

}
