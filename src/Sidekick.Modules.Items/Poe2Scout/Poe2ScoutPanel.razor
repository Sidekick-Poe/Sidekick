@using Sidekick.Apis.Poe2Scout.History.Models
@using Sidekick.Modules.Items.Components.Prices
@using Sidekick.Modules.Items.PoeNinja.Localization

@if (LastLog == null || Logs == null)
{
    return;
}

<div class="mb-2 bg-stone-950 rounded-lg">
    <div class="flex flex-nowrap items-center gap-2 pt-1 px-3">
        <PriceDisplay Value="LastLog.Price" Currency="@Currency"/>
        <TextCaption Class="ml-auto">@LastLog.Quantity @(QuantityLabel ?? NinjaResources["Listings"])</TextCaption>
    </div>
    <Poe2ScoutChart Logs="Logs" QuantityLabel="@(QuantityLabel ?? NinjaResources["Listings"])"/>
</div>

@inject IStringLocalizer<PoeNinjaResources> NinjaResources

@code {

    [Parameter]
    public List<ScoutHistoryLog>? Logs { get; set; }

    [Parameter]
    public required string Currency { get; set; }

    [Parameter]
    public string? QuantityLabel { get; set; }

    private ScoutHistoryLog? LastLog { get; set; }

    protected override void OnParametersSet()
    {
        LastLog = Logs?.LastOrDefault();
        base.OnParametersSet();
    }

}