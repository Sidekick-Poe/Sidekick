@using Microsoft.Extensions.DependencyInjection
@using Microsoft.Extensions.Options
@using Sidekick.Common
@using Sidekick.Common.Platform
@using Sidekick.Common.Ui.Forms
@using Sidekick.Common.Ui.Buttons

@if (Configuration.Value.SupportsKeybinds)
{
    <FormFieldset Legend="Keybinds">
        <ButtonPrimary OnClick="Register">Bind keyboard hooks</ButtonPrimary>
    </FormFieldset>
}

@inject IServiceProvider ServiceProvider
@inject IOptions<SidekickConfiguration> Configuration

@code {

    private IKeyboardProvider? KeyboardProvider { get; set; }

    protected override void OnInitialized()
    {
        if (Configuration.Value.SupportsKeybinds)
        {
            KeyboardProvider = ServiceProvider.GetService<IKeyboardProvider>();
        }

        base.OnInitialized();
    }

    private void Register()
    {
        KeyboardProvider?.RegisterHooks();
    }

}
