@using Sidekick.Common.Blazor.Localization
@using Sidekick.Common.Cache
@using System.Diagnostics
@inherits LayoutComponentBase

<AppTitle Title="Sidekick"/>
<LayoutTwoColumn>
    <TopContent>
        <AppBar>
            <AppMinimize/>
            <AppMaximize/>
            <AppClose/>
        </AppBar>
    </TopContent>
    <LeftContent>
        <MenuList>
            <MenuItem Href="/home">@Resources["Home"]</MenuItem>

            <MenuLegend Legend="@Resources["Settings"]"/>
            <MenuItem Href="/settings">@Resources["General"]</MenuItem>
            <MenuItem Href="/settings/price">@Resources["Price_Check"]</MenuItem>
            <MenuItem Href="/settings/map">@Resources["Map_Check"]</MenuItem>
            <MenuItem Href="/settings/wiki">@Resources["Wiki"]</MenuItem>
            <MenuItem Href="/settings/chat">@Resources["Chat_Commands"]</MenuItem>

            @if (Debugger.IsAttached)
            {
                <MenuItem Href="/settings/wealth">@Resources["WealthTracker"]</MenuItem>
            }

            <MenuItem Href="/settings/about">@Resources["About"]</MenuItem>

            @if (Debugger.IsAttached)
            {
                <MenuLegend Legend="@Resources["Development"]"/>
                <MenuItem Href="/development">Development</MenuItem>
            }

            <div class="grow"></div>

            <div class="py-2">
                <ButtonSecondary OnClick="ResetCache">@Resources["Reset_Cache"]</ButtonSecondary>
            </div>
        </MenuList>
    </LeftContent>
    <ChildContent>
        @Body
    </ChildContent>
</LayoutTwoColumn>

@inject IStringLocalizer<SettingsResources> Resources
@inject ICacheProvider CacheProvider
@inject NavigationManager NavigationManager

@code {

    public async Task ResetCache()
    {
        await CacheProvider.Clear();
        NavigationManager.NavigateTo("/initialize");
    }

}
